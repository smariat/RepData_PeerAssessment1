library(plyr)
library(timeDate)
#Read the data into Rstudio
activity <- read.csv(".activity.csv")
head(activity) #Take a look at the data

df <-na.omit(activity) # The file with the NA's removed
d2 <- activity #the file that will ultimately hold the corrected data

x <- ddply(df, .(as.Date(date)), summarize, freq=length(steps), tot=sum(steps), xmn = mean(steps), xmed = median(steps))
xbar <-mean(x$tot/288, na.rm = TRUE) # calculate a baseline value to plug into NA's later
x_bar <- mean(x$tot) # Calculate the average number of steps taken daily
x_med <- median(x$tot)
d2[is.na(d2)] <- xbar # d2 is the corrected data frame without NA's
hist(x$tot, breaks = 10, main= "Histogram of Total Steps taken each Day", xlab = "Total Steps")

print(paste("The mean is",x_bar))
print(paste("The median is",x_med))

xx <- ddply(df, .(interval), summarize, freq=length(steps), tot=sum(steps)/freq)
wrk <- xx[,-2]
plot(wrk,type ="l", main = "Average Number of steps across all days")

ind <- which.max(xx$tot) #the index of the max value
g <- activity[!complete.cases(activity),] # find the number of rows with NA's

xfix <- ddply(d2, .(as.Date(date)), summarize, freq=length(steps), tot=sum(steps), xmn = mean(steps), xmed = median(steps))
hist(xfix$tot, breaks = 10, main= "Histogram of Total Steps taken each Day", xlab = "Total Steps")

x_bar <- mean(xfix$tot) # calculate the mean number of steps taken daily
x_med <- median(xfix$tot)

#Next is the average number of the steps based on weekdays or weekends
d2$day <- isWeekday(d2$date)
d2$state <- ifelse(d2$day =="TRUE", "Weekday","Weekend")
workday <- d2[which (d2$state == "Weekday"),]
offday <- d2[which (d2$state == "Weekend"),]
wx1 <- ddply(workday, .(interval), summarize, freq=length(steps), tot=sum(steps)/freq)
wx2 <- ddply(offday, .(interval), summarize, freq=length(steps), tot=sum(steps)/freq)
wx1 <- wx1[,-2]
wx2 <- wx2[,-2]
par(mar = c(1,1,0.75,1), oma = c(2,5,2,5), mfrow = c(2,1), cex.main = 0.75)
with (wx1, plot(tot~interval, type = 'l', xaxt = 'n', main = 'Weekday'))
with(wx2, plot(tot ~ interval, type = 'l', main = 'Weekend'))
mtext("Weekday vs Weekend", side=3, line=1, cex=1, col="blue", outer=TRUE)
